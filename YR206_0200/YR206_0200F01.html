<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>YR206_0200F01</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: YR206_0200F01</b></font>
<hr>
<pre width="100">
FORM SET_ALV_0100 .


  "오브잭트 생성

  PERFORM REACTE_OBJECT.

  "필드카탈로그 셋팅

  PERFORM SET_FILEDCAT.

  "레이아웃 셋팅

  PERFORM SET_LAYOUT.

  " GRID DISPLAY.

  PERFORM DISPLAY_GIRD.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GET_DATA</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*FORM GET_DATA .</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR GT_DISP.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT MATNR ERSDA ERNAM LAEDA AENAM VPSTA PSTAT LVORM MTART MBRSH</font>
<font color ="#0000FF">*   INTO CORRESPONDING FIELDS OF TABLE GT_DISP</font>
<font color ="#0000FF">*    FROM MARA</font>
<font color ="#0000FF">*    WHERE MTART IN S_MTART</font>
<font color ="#0000FF">*      AND MATNR IN S_MATNR</font>
<font color ="#0000FF">*      AND ERSDA IN S_ERSDA</font>
<font color ="#0000FF">*      AND ERNAM IN S_ERNAM</font>
<font color ="#0000FF">*      AND LAEDA IN S_LAEDA</font>
<font color ="#0000FF">*      AND AENAM IN S_AENAM</font>
<font color ="#0000FF">*      AND VPSTA IN S_VPSTA</font>
<font color ="#0000FF">*      AND MTART IN S_MTART</font>
<font color ="#0000FF">*      AND MATKL IN S_MATKL.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*ENDFORM.</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form REACTE_OBJECT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM REACTE_OBJECT .
  CREATE OBJECT GO_CUSTOM_CONTAINER
    EXPORTING
      CONTAINER_NAME = 'GO_CUSTOM_CONTAINER'.
  CREATE OBJECT GO_GRID
    EXPORTING
      I_PARENT = GO_CUSTOM_CONTAINER.
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_FILEDCAT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FILEDCAT .
  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'BUKRS'.
  GS_FIELDCAT-COLTEXT = 'BUKRS'.
  "GS_FIELDCAT-KEY = 'X'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'EBELN '.
  GS_FIELDCAT-COLTEXT = 'EBELN'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'BSTYP'.
  GS_FIELDCAT-COLTEXT = 'BSTYP'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'BSART'.
  GS_FIELDCAT-COLTEXT = 'BSART'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'BATXT'.
  GS_FIELDCAT-COLTEXT = 'BATXT'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'LIFNR'.
  GS_FIELDCAT-COLTEXT = 'LIFNR'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.
  "GS_FIELDCAT-KEY = 'O'.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'MATNR'.
  GS_FIELDCAT-COLTEXT = 'MATNR'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'MAKTX'.
  GS_FIELDCAT-COLTEXT = 'MAKTX'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'MENGE'.
  GS_FIELDCAT-COLTEXT = 'MENGE'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'AEDAT'.
  GS_FIELDCAT-COLTEXT = 'AEDAT'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_LAYOUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_LAYOUT .
  GS_LAYOUT-ZEBRA = 'X'. "퐁당포당
  GS_LAYOUT-CWIDTH_OPT = 'X'.  "데이터 크기 만큼 증가
  GS_LAYOUT-SEL_MODE = 'D'. "드레그 가능
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form DISPLAY_GIRD</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM DISPLAY_GIRD .
  CALL METHOD GO_GRID-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      IS_LAYOUT       = GS_LAYOUT
    CHANGING
      IT_OUTTAB       = GT_DISP
      IT_FIELDCATALOG = GT_FIELDCAT.
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GET_DATA</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM GET_DATA .



  CLEAR GT_DISP.

  SELECT
         A~MANDT
         A~BUKRS
         A~EBELN
         A~BSTYP
         A~BSART
         B~MATNR
         B~MENGE
         B~AEDAT

    INTO CORRESPONDING FIELDS OF TABLE GT_DISP
    FROM EKKO AS A INNER JOIN EKPO AS B
    ON A~EBELN = B~EBELN
    WHERE A~BUKRS IN P_BUKRS
      AND A~EBELN IN S_EBELN
      AND B~MATNR IN S_MATNR
      AND A~AEDAT IN S_AEDAT.


  SELECT B~MATNR
         A~BATXT
         B~MAKTX

 INTO CORRESPONDING FIELDS OF TABLE LT_BB
 FROM T161T AS A INNER JOIN MAKT AS B
 ON A~SPRAS = B~SPRAS
 WHERE A~SPRAS = '3'.

LOOP AT GT_DISP INTO GS_DISP .

    READ TABLE LT_BB INTO LS_BB
                       WITH KEY MATNR = GS_DISP-MATNR.



    IF SY-SUBRC = 0.

      GS_DISP-BATXT = LS_BB-BATXT.
      GS_DISP-MAKTX = LS_BB-MAKTX.
      MODIFY GT_DISP FROM GS_DISP.

    ENDIF.

  ENDLOOP.




<font color ="#0000FF">*  LOOP AT GT_DISP INTO GS_DISP.</font>
<font color ="#0000FF">*   APPEND GS_DISP TO GT_DISP1.</font>
<font color ="#0000FF">*  ENDLOOP.</font>

<font color ="#0000FF">*  LOOP AT GT_DISP1 INTO GS_DISP.</font>
<font color ="#0000FF">*    COLLECT GS_DISP INTO GT_DISP2.</font>
<font color ="#0000FF">*  ENDLOOP.</font>


  LOOP AT GT_DISP INTO GS_DISP .

    DATA : A TYPE EKPO-MENGE,
           B TYPE EKPO-EBELN,
           C LIKE GS_DISP.
    "APPEND GS_DISP TO GT_DISP1.
    B = GS_DISP-EBELN.

    READ TABLE GT_DISP INTO GS_DISP
                       WITH KEY EBELN = GS_DISP-EBELN
                                MENGE = GS_DISP-MENGE.



    IF SY-SUBRC = 0.

      A = A + GS_DISP-MENGE.
      GS_DISP-MENGE = A .
      MODIFY GT_DISP FROM GS_DISP.
      APPEND GS_DISP TO GT_DISP2.
      C = GS_DISP.

      IF B &lt;&gt; GS_DISP-EBELN.
        APPEND GS_DISP TO GT_DISP1.
      ENDIF.
    ENDIF.



<font color ="#0000FF">*        READ TABLE LT_T134T1 INTO LS_T134T1</font>
<font color ="#0000FF">*                       WITH KEY MTART = LS_MARA1-MTART.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    IF SY-SUBRC = 0.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      LS_MARA1-MTBEZ = LS_T134T1-MTBEZ.</font>
<font color ="#0000FF">*</font>


  ENDLOOP.


ENDFORM.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 751
</font>
</body>
</html>
