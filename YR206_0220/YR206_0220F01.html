<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>YR206_0220F01</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: YR206_0220F01</b></font>
<hr>
<pre width="100">
FORM SET_ALV_0100 .

  IF GO_CUSTOM_CONTAINER IS INITIAL."이니셜 초기 상태를 나타냄

    "오브잭트 생성

    PERFORM REACTE_OBJECT.

    "필드카탈로그 셋팅

    PERFORM SET_FILEDCAT.

    "레이아웃 셋팅

    PERFORM SET_LAYOUT.

    " GRID DISPLAY.

    PERFORM DISPLAY_GIRD.

  ELSE.
    "REFRESH
    CALL METHOD GO_GRID-&gt;REFRESH_TABLE_DISPLAY.


  ENDIF.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GET_DATA</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*FORM GET_DATA .</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR GT_DISP.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT MATNR ERSDA ERNAM LAEDA AENAM VPSTA PSTAT LVORM MTART MBRSH</font>
<font color ="#0000FF">*   INTO CORRESPONDING FIELDS OF TABLE GT_DISP</font>
<font color ="#0000FF">*    FROM MARA</font>
<font color ="#0000FF">*    WHERE MTART IN S_MTART</font>
<font color ="#0000FF">*      AND MATNR IN S_MATNR</font>
<font color ="#0000FF">*      AND ERSDA IN S_ERSDA</font>
<font color ="#0000FF">*      AND ERNAM IN S_ERNAM</font>
<font color ="#0000FF">*      AND LAEDA IN S_LAEDA</font>
<font color ="#0000FF">*      AND AENAM IN S_AENAM</font>
<font color ="#0000FF">*      AND VPSTA IN S_VPSTA</font>
<font color ="#0000FF">*      AND MTART IN S_MTART</font>
<font color ="#0000FF">*      AND MATKL IN S_MATKL.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*ENDFORM.</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form REACTE_OBJECT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM REACTE_OBJECT .
  CREATE OBJECT GO_CUSTOM_CONTAINER
    EXPORTING
      CONTAINER_NAME = 'GO_CUSTOM_CONTAINER'.
  CREATE OBJECT GO_GRID
    EXPORTING
      I_PARENT = GO_CUSTOM_CONTAINER.
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_FILEDCAT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_FILEDCAT .
  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'BUKRS'.
  GS_FIELDCAT-COLTEXT = 'BUKRS'.
  "GS_FIELDCAT-KEY = 'X'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'EBELN '.
  GS_FIELDCAT-COLTEXT = 'EBELN'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'BSTYP'.
  GS_FIELDCAT-COLTEXT = 'BSTYP'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'BSART'.
  GS_FIELDCAT-COLTEXT = 'BSART'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'BATXT'.
  GS_FIELDCAT-COLTEXT = 'BATXT'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'LIFNR'.
  GS_FIELDCAT-COLTEXT = 'LIFNR'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.
  "GS_FIELDCAT-KEY = 'O'.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'MATNR'.
  GS_FIELDCAT-COLTEXT = 'MATNR'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'MAKTX'.
  GS_FIELDCAT-COLTEXT = 'MAKTX'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'MENGE'.
  GS_FIELDCAT-COLTEXT = 'MENGE'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.

  CLEAR GS_FIELDCAT.
  GS_FIELDCAT-FIELDNAME = 'AEDAT'.
  GS_FIELDCAT-COLTEXT = 'AEDAT'.
  APPEND GS_FIELDCAT TO GT_FIELDCAT.


ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SET_LAYOUT</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SET_LAYOUT .
  GS_LAYOUT-ZEBRA = 'X'. "퐁당포당
  GS_LAYOUT-CWIDTH_OPT = 'X'.  "데이터 크기 만큼 증가
  GS_LAYOUT-SEL_MODE = 'D'. "드레그 가능
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form DISPLAY_GIRD</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM DISPLAY_GIRD .
  CALL METHOD GO_GRID-&gt;SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      IS_LAYOUT       = GS_LAYOUT
    CHANGING
      IT_OUTTAB       = GT_DISP
      IT_FIELDCATALOG = GT_FIELDCAT.
ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GET_DATA</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM GET_DATA .





  DATA : BEGIN OF LS_BSART_T,
           BSTYP TYPE T161T-BSTYP,
           BSART TYPE T161T-BSART,
           BATXT TYPE T161T-BATXT,
         END OF LS_BSART_T.


  DATA : BEGIN OF LS_MAKTX_T,
           MAKTX TYPE MAKT-MAKTX,
           SPRAS TYPE MAKT-SPRAS,
           MATNR TYPE MAKT-MATNR,
         END OF LS_MAKTX_T.

  DATA : LT_BSART_T LIKE TABLE OF LS_BSART_T,
         LT_MAKTX_T LIKE TABLE OF LS_MAKTX_T.

  CLEAR GT_DISP.

<font color ="#0000FF">* 구매문서 데이터 조회</font>
  SELECT A~EBELN A~BUKRS A~BSART A~LIFNR A~BSTYP
         B~MENGE B~MATNR B~AEDAT
    INTO CORRESPONDING FIELDS OF TABLE GT_DISP
    FROM EKKO AS A INNER JOIN EKPO AS B
      ON A~EBELN = B~EBELN
   WHERE A~EBELN IN S_EBELN
     AND A~BUKRS IN S_BUKRS
     AND B~AEDAT IN S_AEDAT.

<font color ="#0000FF">* 구매문서 유형/범주 내역</font>
<font color ="#0000FF">**  SELECT BSTYP BSART BATXT</font>
<font color ="#0000FF">**    INTO CORRESPONDING FIELDS OF TABLE LT_BSART_T</font>
<font color ="#0000FF">**    FROM T161T</font>
<font color ="#0000FF">**   WHERE SPRAS = SY-LANGU.</font>
  IF GT_DISP IS NOT INITIAL.
    SELECT BSTYP BSART BATXT
      INTO CORRESPONDING FIELDS OF TABLE LT_BSART_T
      FROM T161T
       FOR ALL ENTRIES IN GT_DISP
     WHERE SPRAS = SY-LANGU
       AND BSTYP = GT_DISP-BSTYP
       AND BSART = GT_DISP-BSART.
  ENDIF.

  IF GT_DISP IS NOT INITIAL.
    SELECT MAKTX SPRAS MATNR
      INTO CORRESPONDING FIELDS OF TABLE LT_MAKTX_T
      FROM MAKT
       FOR ALL ENTRIES IN GT_DISP
     WHERE MATNR = GT_DISP-MATNR
       AND SPRAS = SY-LANGU.
  ENDIF.

  SORT LT_BSART_T BY BSTYP BSART. " 옵션안주면 무조건 오름차순 DESCENDING &lt;&lt;내림차순 ASCENDING &lt;&lt;오름차순
  SORT LT_MAKTX_T BY MATNR.


  LOOP AT GT_DISP INTO GS_DISP.


    READ TABLE LT_BSART_T INTO LS_BSART_T WITH KEY BSTYP = GS_DISP-BSTYP
                                                   BSART = GS_DISP-BSART
                                                   BINARY SEARCH.

    IF SY-SUBRC = 0.
      GS_DISP-BATXT = LS_BSART_T-BATXT.
    ENDIF.

    READ TABLE LT_MAKTX_T INTO LS_MAKTX_T WITH KEY MATNR = GS_DISP-MATNR
                                                           BINARY SEARCH.

    IF SY-SUBRC = 0.
      GS_DISP-MAKTX = LS_MAKTX_T-MAKTX.
    ENDIF.

    MODIFY GT_DISP FROM GS_DISP.

  ENDLOOP.

ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form SHOW_MATERIAL_DETAIL</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM SHOW_MATERIAL_DETAIL .

  DATA : LT_INDEX_ROWS TYPE LVC_T_ROW,
         LT_ROID       TYPE LVC_T_ROID.

  DATA : LS_INDEX_ROWS TYPE LVC_S_ROW.

  DATA : AA TYPE C LENGTH 10.

  AA = '올로로로로'.


  "ALV에서 선택라인 확인 (선택라인 확인 무엇이 클릭 되어 있는지)
  CALL METHOD GO_GRID-&gt;GET_SELECTED_ROWS
    IMPORTING
      ET_INDEX_ROWS = LT_INDEX_ROWS.

  "메세지 호출
  IF LT_INDEX_ROWS IS INITIAL.
"S 왼쪽 아래글 I는 팝업 E 왼쪽 아래 오류 메세지로
    MESSAGE I002 WITH AA.

  ELSE.

    "ALV에서 선택 라인 선택

    READ TABLE LT_INDEX_ROWS INTO LS_INDEX_ROWS INDEX 1.

    " 인터널 테이블 에서 선택라인 선택

    READ TABLE GT_DISP INTO GS_DISP INDEX LS_INDEX_ROWS-INDEX.

    PERFORM GET_MATERIAL_DETAIL.

    CALL SCREEN 0200 STARTING AT 5 5.

  ENDIF.



ENDFORM.
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Form GET_MATERIAL_DETAIL</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& --&gt;  p1        text</font>
<font color ="#0000FF">*& &lt;--  p2        text</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
FORM GET_MATERIAL_DETAIL .

  call function <a href ="yf_get_material_info_206/yf_get_material_info_206.html">'YF_GET_MATERIAL_INFO_206'</a>
    EXPORTING
      I_MATNR = GS_DISP-MATNR
    IMPORTING
      ES_MARA = GS_DISP_0200.


<font color ="#0000FF">*  CLEAR GS_DISP_0200.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT SINGLE MATNR ERSDA MTART MATKL ERNAM MBRSH MEINS</font>
<font color ="#0000FF">*       INTO CORRESPONDING FIELDS OF GS_DISP_0200</font>
<font color ="#0000FF">*       FROM MARA</font>
<font color ="#0000FF">*      WHERE MATNR = GS_DISP-MATNR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT SINGLE MAKTX</font>
<font color ="#0000FF">*    INTO GS_DISP_0200-MAKTX</font>
<font color ="#0000FF">*    FROM MAKT</font>
<font color ="#0000FF">*   WHERE MATNR = GS_DISP_0200-MATNR</font>
<font color ="#0000FF">*     AND SPRAS = SY-LANGU.</font>
ENDFORM.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 751
</font>
</body>
</html>
